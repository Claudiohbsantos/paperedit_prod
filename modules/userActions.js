"use strict";import*as utils from"./utils.js";import player from"./player.js";import editor from"./quill.js";import paperedit from"./transcript.js";export default{playPause:{label:"Play/Pause",handler:()=>{player.playPause()}},skipBack:{label:"Skip Backwards",handler:()=>{player.skipBackward()}},skipForward:{label:"Skip Forward",handler:()=>{player.skipForward()}},goToTime:{label:"Go To Time",handler:()=>{document.getElementById("btn-goto").dispatchEvent(new Event("click"))}},toggleSkipStriked:{label:"Toggle Skip Striked Sections While Playing",handler:()=>{player.skipStriked=!player.skipStriked,player.skipStriked?(player.on("audioprocess",skipStrikedSegments),changeFilterIcon(!1)):(player.un("audioprocess",skipStrikedSegments),changeFilterIcon(!0))}},goToNextMarker:{label:"Go To Next Timestamp",handler:()=>{let e=player.getCurrentTime(),t=paperedit.getNextSection(e);t&&player.seekToSec(t.time)}},goToPreviousMarker:{label:"Go To Previous Timestamp",handler:()=>{let e=player.getCurrentTime(),t=paperedit.getPreviousSection(e);t&&player.seekToSec(t.time)}},selectSectionInEditor:{label:"Select Playing Section in Editor",handler:e=>{let t=e&&e.start?e.start:player.getCurrentTime(),i=paperedit.getSection(t);i&&i.select()}},strike:{label:"Strike Section",handler:()=>{let e=editor.quill.getSelection();if(e)if(e.length>0){let t=editor.quill.getFormat().strike||!1;editor.quill.formatText(e,"strike",!t,"user")}else{let t=paperedit.getSectionAtIndex(e.index);if(t){let e=t.getLineRange(),i=editor.quill.getFormat(e).strike||!1;editor.quill.formatText(e,"strike",!i,"user")}else{let t=editor.getLineInfo(e.index),i=editor.quill.getFormat({index:t.index,length:t.endIndex-t.index}).strike||!1;editor.quill.formatText({index:t.index,length:t.endIndex-t.index},"strike",!i,"user")}}}},insertCurrentTimestamp:{label:"Insert Current Time as Timestamp",handler:()=>{let e=editor.quill.getSelection();if(!e)return;let t=`[${utils.tsFromSeconds(player.getCurrentTime())}] `;editor.quill.insertText(e.index,t,{},"user"),editor.quill.setSelection(e.index+t.length,0)}},seekToCurrentSection:{label:"Go to selected section",handler:()=>{let e=editor.quill.getSelection();if(!e)return;let t=paperedit.getSectionAtIndex(e.index);t&&player.seekToSec(t.time)}},hideStriked:{label:"Hide Striked Sections",handler:()=>{0==document.getElementsByClassName("hidden-strikes").length?hideStrikedText():showStrikedText()}}};function skipStrikedSegments(e){player.skipStrikedSegments(e,paperedit.getStrikes())}function hideStrikedText(){document.getElementById("quill-container").classList.add("hidden-strikes"),changeHideStrikedIcon(!1)}function showStrikedText(){document.getElementById("quill-container").classList.remove("hidden-strikes"),changeHideStrikedIcon(!0)}function changeHideStrikedIcon(e){let t=document.getElementById("svg-hidestriked");if(e){let e=document.createElementNS("http://www.w3.org/2000/svg","line");e.setAttribute("id","eye-inactive"),e.setAttribute("x1","0"),e.setAttribute("y1","10"),e.setAttribute("x2","50"),e.setAttribute("y2","40"),e.setAttribute("stroke","black"),t.appendChild(e)}else{let e=document.getElementById("eye-inactive");e&&e.remove()}}function changeFilterIcon(e){let t=document.getElementById("svg-filter");if(e){let e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.setAttribute("id","filter-inactive"),e.setAttribute("x","0"),e.setAttribute("y","35"),e.setAttribute("width","50"),e.setAttribute("height","2"),t.appendChild(e)}else{let e=document.getElementById("filter-inactive");e&&e.remove()}}