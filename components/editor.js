"use strict";import actions from"../modules/userActions.js";import player from"../modules/player.js";import editor from"../modules/quill.js";import paperedit from"../modules/transcript.js";export default function init(){document.getElementById("title-input").addEventListener("change",updateTitle),document.addEventListener("playerStarted",attachPlayerListeners)}function attachPlayerListeners(){player.on("seek",e=>highlightPlayingSection(e*player.duration)),player.on("audioprocess",e=>highlightPlayingSection(e)),editor.quill.on("text-change",()=>{highlightPlayingSection(player.getCurrentTime(),!0)}),document.getElementById("editor-container").addEventListener("section-deleted",()=>{highlightPlayingSection(player.getCurrentTime(),!0)}),document.getElementById("quill-container").addEventListener("click",e=>{e.ctrlKey&&actions.seekToCurrentSection.handler()})}function highlightPlayingSection(e,t){let i=paperedit.getSection(e);if(i||(player.currentSection=null),i&&i.line){if(!player.currentSection||t||i.time!==player.currentSection.time){player.currentSection=i;let e=editor.quill.getBounds(i.getIndex(),i.line.length),t=document.getElementById("playingsection"),n=document.getElementById("title-input").getBoundingClientRect().height;t.style.top=e.top+n+"px",t.style.height=e.height+"px"}}else{document.getElementById("playingsection").style.height="0px"}}function updateTitle(e){paperedit.title=e.target.value.trim(),document.title=e.target.value.trim()+" - Paperedit"}