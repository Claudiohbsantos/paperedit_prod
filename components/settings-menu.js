"use strict";let deferredPrompt;import player from"../modules/player.js";import paperedit from"../modules/transcript.js";import keybindingsSettings from"./keybindings-settings.js";import exportSettings from"./export-settings.js";import{Component}from"./component.js";class SettingsMenu extends Component{constructor(){super(document.getElementById("settings-menu")),this.attachListeners()}attachListeners(){this.element.addEventListener("click",()=>this.hide()),document.getElementById("btn-fullscreen").addEventListener("click",e=>{enableFullscreen(e)}),document.getElementById("btn-clear-data").addEventListener("click",()=>{clearData()}),document.getElementById("btn-exp-settings").addEventListener("click",()=>exportSettings.show()),document.getElementById("btn-keybindings").addEventListener("click",()=>keybindingsSettings.show()),window.addEventListener("beforeinstallprompt",e=>{deferredPrompt=e,this.addInstallButton()})}addInstallButton(){let e=document.getElementById("btn-fullscreen"),t=e.cloneNode();t.textContent="Install PaperEdit as App",t.addEventListener("click",installApp),document.getElementById("settings-btnlist").insertBefore(t,e)}}let singleton=new SettingsMenu;export default singleton;function installApp(e){deferredPrompt.prompt(),deferredPrompt.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")})}function enableFullscreen(e){document.fullscreenEnabled&&(document.fullscreenElement?(document.exitFullscreen(),e.target.textContent="Fullscreen [f11]"):(document.documentElement.requestFullscreen(),e.target.textContent="Exit Fullscreen [f11]"))}function clearData(){localStorage.removeItem("papercut"),player.unloadAudio(),paperedit.loadPapercut({delta:{}})}